{% load s3tags %}
{% load i18n %}
{% load_s3_header %}
{% load static %}

<div class="pb-filemng-template">
    <div class="row">
        <div class="col-sm-12">
            <!--File Manager-->
            <nav class="navbar navbar-default pb-filemng-navbar">
                <div class="container-fluid">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                                data-target="#pb-filemng-navigation" aria-expanded="false">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                    </div>

                    <div class="navbar-form navbar-left bucket-picker">
                        <label for="bucket-selector" class="control-label">{% trans "Bucket:" %}</label>
                        <select id="bucket-selector" class="form-control input-sm" onchange="change_bucket(this);">
                            {% for bucket in buckets %}
                                <option value="{{ bucket.name }}" {% if bucket.name == default_bucket %}selected{% endif %}>{{ bucket.label }}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <div class="collapse navbar-collapse" id="pb-filemng-navigation">
                        <ul class="nav navbar-nav">
                            <li><a href="javascript:;" id="top_folder" data-top_folder="-" onclick="back_folder(this);"><span
                                    class="fa fa-chevron-left fa-lg"></span></a></li>
                            <li class="pb-filemng-active"><a href="javascript:;" onclick="get_files('-');"><span
                                    class="fa fa-home fa-lg"></span></a></li>
                        </ul>
                    </div>
                </div>
            </nav>

            <div class="panel panel-default">
                <div class="panel-heading">
                    <div id="breadcrumb" class="pb-breadcrumb"></div>
                    <div class="btn-toolbar pb-toolbar" role="toolbar">
                        <div class="btn-group">
                            <button type="button" class="btn btn-primary btn-sm" data-toggle="collapse" data-target="#collapseUpload"><span class="fa fa-upload"></span> {% trans "Upload" %}</button>
                            <button type="button" class="btn btn-default btn-sm" data-toggle="collapse" data-target="#collapseCreateFolder"><span class="fa fa-folder"></span> {% trans "New Folder" %}</button>
                            <button type="button" class="btn btn-default btn-sm" onclick="refresh_folder();"><span class="fa fa-refresh"></span> {% trans "Refresh" %}</button>
                        </div>
                        <div class="btn-group">
                            <button type="button" class="btn btn-default btn-sm" onclick="sort_a_z(this);" data-sort="a-z"><span class="fa fa-sort-alpha-asc"></span> {% trans "Sort" %}</button>
                        </div>
                        <div class="btn-group pull-right">
                            <button type="button" class="btn btn-default btn-sm" onclick="copy_selected_file();"><span class="fa fa-files-o"></span> {% trans "Copy" %}</button>
                            <button type="button" class="btn btn-default btn-sm hidden" id="paste_file" onclick="paste_file();"><span class="fa fa-clipboard"></span> {% trans "Paste" %}</button>
                            <button type="button" class="btn btn-default btn-sm hidden" id="move_file" onclick="move_selected_file();"><span class="fa fa-arrows-alt"></span> {% trans "Move" %}</button>
                            <button type="button" class="btn btn-default btn-sm" onclick="download_files();"><span class="fa fa-download"></span> {% trans "Download" %}</button>
                            <button type="button" class="btn btn-danger btn-sm" onclick="delete_file();"><span class="fa fa-trash-o"></span> {% trans "Delete" %}</button>
                        </div>
                    </div>
                </div>

                <!--Create Folder-->
                <div class="collapse" id="collapseCreateFolder">
                    <div class="panel panel-default">
                        <div class="panel-body">
                            <div class="form-inline">
                                <div class="form-group">
                                    <input class="form-control" id="created_folder_name"
                                           placeholder="{% trans "Folder Name" %}">
                                </div>
                                <button type="button" class="btn btn-sm btn-primary"
                                        onclick="create_folder()">{% trans "Create" %}</button>
                            </div>
                        </div>
                    </div>
                </div>
                <!--File Upload-->
                <div class="collapse" id="collapseUpload">
                    <div class="panel panel-default">
                        <div class="panel-body">
                            <!-- Standar Form -->
                            <h4>{% blocktrans %}Select files from your computer{% endblocktrans %}</h4>
                            <form action="" method="post" enctype="multipart/form-data" id="js-upload-form">
                                <div class="form-inline">
                                    <div class="form-group">
                                        <input type="file" name="files[]" id="js-upload-files" multiple>
                                    </div>
                                    <button type="submit" class="btn btn-sm btn-primary"
                                            id="js-upload-submit">{% trans "Upload files" %}
                                    </button>
                                </div>
                            </form>

                            <!-- Drop Zone -->
                            <h4>{% blocktrans %}Or drag and drop files below{% endblocktrans %}</h4>
                            <div class="upload-drop-zone" id="drop-zone">
                                {% blocktrans %}Just drag and drop files here{% endblocktrans %}
                            </div>

                            <!-- Progress Bar -->
                            <div class="progress">
                                <div class="progress-bar" id="progress-bar" role="progressbar" aria-valuenow="60"
                                     aria-valuemin="0"
                                     aria-valuemax="100" style="width: 0%;">
                                    <span id="progress-bar-rate" style="color: black;" class="">0</span>
                                    <span style="color: black;" class="">{% trans "Complete" %}</span>
                                </div>
                            </div>

                            <!-- Upload Finished -->
                            <div class="js-upload-finished" id="js-upload-finished">
                                <h3>{% trans "Processed files" %}</h3>
                                <div class="list-group" id="js-upload-finished-list">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="panel-body pb-filemng-panel-body">
                    <div class="table-responsive">
                        <table class="table table-hover table-condensed" id="file-table">
                            <thead>
                            <tr>
                                <th style="width:40px;"></th>
                                <th>{% trans "Name" %}</th>
                                <th style="width:120px;">{% trans "Type" %}</th>
                                <th style="width:120px;">{% trans "Size" %}</th>
                                <th style="width:180px;">{% trans "Modified" %}</th>
                            </tr>
                            </thead>
                            <tbody class="pb-filemng-template-body"></tbody>
                        </table>
                        <p id="empty-folder-msg" class="text-center text-muted hidden">{% trans "Folder is Empty" %}</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="location" data-location="-"></div>
    <div id="bucket" data-bucket="{{ default_bucket }}"></div>
</div>
<script>
    const FILES_URL = "{% url 'get_folder_items' 'arg1djs3server' 'sort_a_z' %}"
    const UPLOAD_URL = '{% url "upload" %}'
    const CREATE_FOLDER_URL = '{% url "create_folder" %}'
    const PAST_FILE_URL = '{% url "paste_file" %}'
    const DELETE_FILE_URL = '{% url "delete_file" %}'
    const DOWNLOAD_URL = '{% url "download" %}'
    const RENAME_URL = '{% url "rename_file" %}'
    const MOVE_FILE_URL = '{% url "move_file" %}'
    const SUCCESS_MSG = '<span class="badge alert-success pull-right">{% trans "Success" %}</span>'
    const FAIL_MSG = '<span class="badge alert-danger pull-right">{% trans "Fail" %}</span>'
</script>
<div id="toast-container" class="toast-container"></div>
<script type="text/javascript" src="{% static 'js/filebrowser.js' %}"></script>
